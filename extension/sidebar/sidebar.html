<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenCue</title>
  <link rel="stylesheet" href="sidebar.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>OpenCue</h1>
      <p class="tagline">Cue-based playback overlays</p>
    </header>

    <section class="status">
      <div class="status-indicator">
        <span id="status-dot" class="dot disconnected"></span>
        <span id="status-text">Disconnected</span>
      </div>
    </section>

    <section class="controls">
      <button id="connect-btn" class="btn btn-primary">Connect</button>
      <button id="disconnect-btn" class="btn btn-secondary" disabled>Disconnect</button>
    </section>

    <section class="mode-section">
      <h2>Mode</h2>
      <div class="mode-selector">
        <button id="mode-realtime" class="mode-btn disabled" data-mode="realtime" disabled title="Coming Soon">Real-time</button>
        <button id="mode-cuefile" class="mode-btn" data-mode="cue_file">Cue File</button>
        <button id="mode-recording" class="mode-btn active" data-mode="recording">Record</button>
      </div>
      <p id="mode-description" class="mode-desc">Record cues while watching, then save for later</p>
    </section>

    <section id="recording-section" class="recording-section" style="display: none;">
      <h2>Recording</h2>
      <div class="recording-input">
        <input type="text" id="recording-title" placeholder="Title (e.g., Movie Name)" />
        <button id="fetch-title-btn" class="btn btn-small btn-fetch" title="Get title from page">Get Title</button>
      </div>
      <div class="recording-options">
        <span id="duration-display" class="duration-display"></span>
        <label class="auto-stop-label">
          <input type="checkbox" id="auto-stop-checkbox" checked />
          Auto-stop when video ends
        </label>
      </div>
      <div class="recording-controls" id="controls-idle">
        <button id="start-recording" class="btn btn-record">Start Recording</button>
      </div>
      <div class="recording-controls" id="controls-recording" style="display: none;">
        <button id="stop-recording" class="btn btn-stop">Stop & Save</button>
        <button id="abort-recording" class="btn btn-abort">Abort</button>
      </div>
      <div class="recording-controls" id="controls-processing" style="display: none;">
        <button class="btn btn-stop" disabled>Processing...</button>
      </div>
      <div id="recording-status" class="recording-status" style="display: none;">
        <span class="rec-indicator">REC</span>
        <span id="rec-cue-count">0 cues</span>
        <span id="rec-fp-count" class="fp-indicator" title="Audio fingerprints for cross-platform sync">0 fp</span>
        <span id="rec-elapsed">00:00</span>
        <span id="rec-position"></span>
      </div>
      <div id="paused-status" class="paused-status" style="display: none;">
        <span class="paused-indicator">||</span>
        <span>Paused at <span id="paused-position">0:00</span> - <span id="paused-cues">0</span> cues captured</span>
      </div>
      <p class="recording-hint">Audio will be captured silently via VB-Cable. Play the movie, then stop to process with Whisper.</p>
    </section>

    <section id="cue-section" class="cue-section" style="display: none;">
      <h2>Cue Files</h2>
      <div id="current-content-match" class="current-content-match" style="display: none;">
        <div class="match-header">
          <span class="match-icon">Film</span>
          <span id="current-content-title">Current: </span>
        </div>
        <div id="matched-cue-files" class="cue-files-list matched-files">
          <p class="empty-state">No matching cue files</p>
        </div>
      </div>
      <div class="cue-search">
        <input type="text" id="cue-search-input" placeholder="Search cue files by title..." />
        <button id="cue-search-btn" class="btn btn-small">Search</button>
      </div>
      <div id="cue-files-list" class="cue-files-list">
        <p class="empty-state">Loading cue files...</p>
      </div>
      <div id="offset-section" class="offset-section" style="display: none;">
        <label>Timing Offset (for different platform):</label>
        <div class="offset-controls">
          <button id="offset-minus" class="btn btn-small">-5s</button>
          <input type="number" id="offset-value" value="0" step="1" />
          <span>seconds</span>
          <button id="offset-plus" class="btn btn-small">+5s</button>
        </div>
        <p class="offset-hint">Adjust if cues are early (-) or late (+) on this platform</p>
      </div>
      <div id="sync-status" class="sync-status" style="display: none;">
        <span id="sync-indicator" class="sync-indicator">*</span>
        <span id="sync-text">Not synced</span>
      </div>
    </section>

    <section class="info">
      <h2>Recent Activity</h2>
      <div id="activity-log" class="activity-log">
        <p class="empty-state">No activity yet</p>
      </div>
    </section>

    <footer>
      <p>Backend: localhost:8765</p>
      <p>Dashboard: <a href="http://localhost:8080" target="_blank">localhost:8080</a></p>
    </footer>
  </div>

  <script src="sidebar.js"></script>
</body>
</html>
